{"version":3,"sources":["components/ExplainingLabels/ExplainingLabel.js","components/ExplainingLabels/explainingLabels.module.css","components/Modal/OptionsModal/OptionsModal.js","components/TopPagination/TopPagination.js","services/dialogs.js","components/ExplainingLabels/BlacklistedLabel/BlacklistedExplainingLabel.js","components/Modal/OptionsModal/optionsModal.module.css","components/Typing/Typing.js","pages/Dialog/Header/header.module.css","pages/Dialog/Footer/EmojiPicker/emojiPicker.module.css","pages/Dialog/Footer/icons/smile.svg","pages/Dialog/Footer/footer.module.css","pages/Dialog/Message/Post/post.module.css","pages/Dialog/Message/Avatar/avatar.module.css","pages/Dialog/Message/Images/Image/FullScreen/fullScreen.module.css","pages/Dialog/Message/Images/Image/image.module.css","pages/Dialog/Message/Images/images.module.css","pages/Dialog/Message/Images/SingleImage/singleImage.module.css","pages/Dialog/Message/message.module.css","pages/Dialog/MessagesList/messagesList.module.css","pages/Dialog/dialog.module.css","pages/Dialog/Header/Header.js","pages/Dialog/Footer/EmojiPicker/EmojiPicker.js","pages/Dialog/Footer/Footer.js","components/ExplainingLabels/StartMessagingLabel/StartMessagingLabel.js","pages/Dialog/Message/Post/Post.js","pages/Dialog/Message/Avatar/Avatar.js","pages/Dialog/Message/Images/Image/FullScreen/FullScreen.js","pages/Dialog/Message/Images/Image/Image.js","pages/Dialog/Message/Images/Images.js","pages/Dialog/Message/Images/SingleImage/SingleImage.js","pages/Dialog/Message/Message.js","pages/Dialog/MessagesList/Slider/Slider.js","pages/Dialog/MessagesList/MessagesList.js","utils/getImagesUrl.js","pages/Dialog/utils/useMessages.js","pages/Dialog/Dialog.js"],"names":["react__WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","react__WEBPACK_IMPORTED_MODULE_0___default","n","_explainingLabels_module_css__WEBPACK_IMPORTED_MODULE_1__","_explainingLabels_module_css__WEBPACK_IMPORTED_MODULE_1___default","ExplainingLabel","_ref","children","icon","text","a","createElement","className","styles","sectionContainer","iconContainer","sectionLabel","module","exports","_optionsModal_module_css__WEBPACK_IMPORTED_MODULE_1__","_optionsModal_module_css__WEBPACK_IMPORTED_MODULE_1___default","OptionsModal","container","TopPagination","props","_props$loadMoreButton","loadMoreButton","react_default","_props$loader","loader","_props$threshold","threshold","_props$toBottom","toBottom","byWindow","fetcher","withScrollHandler","getScrollParent","rest","Object","objectWithoutProperties","_useState","useState","isFetching","page","lastPage","_useState2","slicedToArray","_useState2$","setState","scrollContainer","useRef","hasMore","useEffect","returnedValue","Promise","then","current","scrollTo","scrollHeight","loadMore","_ref2","assign","ref","onScroll","toTop","window","scrollY","scrollTop","React","cloneElement","onClick","d","__webpack_exports__","get","getByUsername","_Http__WEBPACK_IMPORTED_MODULE_0__","_api__WEBPACK_IMPORTED_MODULE_1__","Http","concat","api","dialogs","username","iconStyle","fontSize","BlacklistedExplainingLabel","react__WEBPACK_IMPORTED_MODULE_3___default","_ExplainingLabel__WEBPACK_IMPORTED_MODULE_2__","antd_es_icon__WEBPACK_IMPORTED_MODULE_1__","type","style","Typing","countOfDots","setCountOfDots","id","setTimeout","clearTimeout","repeat","arrowLeft","avatar","isTyping","p","messageInput","sendButton","inputContainer","emojiIcon","wrapper","myContainer","header","media","caption","scale","img","imgFull","singleImgContainer","mySingleImgContainer","myWrapper","myText","unreadBadge","myTime","time","absoluteWrapper","messages","mobileMessages","explainingContainer","date","withRouter","history","goBack","Link","to","src","alt","DefaultAvatar","EmojiPicker","addEmoji","dist_es","set","color","title","emoji","onSelect","Footer","sendMessage","typing","inputRef","isSendButtonVisible","setIsSendButtonVisible","_useState3","_useState4","isEmojiOpen","setIsEmojiOpen","_useState5","_useState6","messageText","setMessageText","throttledMessageText","useThrottle","length","useCallback","native","focus","Fragment","onSubmit","event","preventDefault","placeholder","maxLength","value","onChange","target","Footer_EmojiPicker_EmojiPicker","StartMessagingLabel","Post","post","my","postCode","error","owner","match","Avatar","memo","images","appRoot","document","getElementById","FullScreen","onClose","listener","keyCode","addEventListener","body","overflow","removeEventListener","createPortal","Image","isFull","setIsFull","Image_FullScreen_FullScreen","stopPropagation","build","effect","wrapperClassName","Images","map","image","index","Images_Image_Image","key","SingleImage","Message","read","deleteMsg","_ref$withAvatar","withAvatar","modalVisible","setModalVisible","closeModal","deleteMessage","Avatar_Avatar","Message_Post_Post","split","linkifyjs_react_default","Message_Images_Images","Images_SingleImage_SingleImage","moment","format","Modal","visible","diff","Slider","_useSpring","useSpring","x","_useSpring2","bind","useGestureResponder","onStartShouldSet","onMove","delta","xy","immediate","onRelease","_ref3","web","div","transform","interpolate","Math","abs","addResistance","MessagesList","user","myId","getMessages","isFirstLoading","lastMessage","isNeedAvatar","prevMessage","is","undefined","owner_id","Loader","MessagesList_Slider_Slider","isMobile","message","created_at","momentLst","momentCur","year","messageDate","Dialog_Message_Message","ExplainingLabels_StartMessagingLabel_StartMessagingLabel","getImagesUrl","asyncToGenerator","regenerator_default","mark","_callee","results","wrap","_context","prev","next","allSettled","isImage","sent","abrupt","filter","result","state","stop","_x","apply","this","arguments","url","resolve","reject","timer","onerror","onabort","onload","getPostCode","postMatches","getPost","PostsService","data","catch","err","prepareMessage","_callee2","_context2","Array","isArray","replace","objectSpread","_x2","initialState","READ_MESSAGES","ADD_MESSAGES","ADD_MESSAGE","DELETE_MESSAGE","reducer","action","toConsumableArray","payload","some","item","msg","Error","useMessages","_useReducer","useReducer","_useReducer2","dispatch","newMessageHandler","isFirstRender","addMessage","DialogsService","_ref5","_callee3","_ref4","_context3","all","_x3","readAllMessages","onNewMessage","messageHandler","connect","auth","params","dialogUser","setDialogUser","setIsTyping","dialog","timerRef","_useMessages","topicName","UsersService","readDialog","wsThread","ws","getSubscription","emit","WsTypes","CONNECTION","receiverId","webSocketCallback","MESSAGE","receiver_id","READ","IS_TYPING","Date","now","clearInterval","DELETE","messageId","ERROR","es_message","on","off","amBlacklisted","Dialog_Header_Header","Dialog_MessagesList_MessagesList","top","behavior","Dialog_Footer_Footer","center"],"mappings":"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","file":"static/js/17.48f79212.chunk.js","sourcesContent":["import React from \"react\";\r\nimport PropTypes from 'prop-types';\r\nimport styles  from './explainingLabels.module.css';\r\n\r\nconst ExplainingLabel = ({children, icon, text}) => (\r\n    <div className={styles.sectionContainer}>\r\n        <div className={styles.iconContainer}>\r\n            {icon}\r\n        </div>\r\n        <span className={styles.sectionLabel}>{text}</span>\r\n        {children}\r\n    </div>\r\n);\r\n\r\nExplainingLabel.propTypes = {\r\n    children: PropTypes.element,\r\n    icon: PropTypes.element.isRequired,\r\n    text: PropTypes.string.isRequired\r\n};\r\n\r\nexport default ExplainingLabel;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"sectionContainer\":\"explainingLabels_sectionContainer__1n9BX\",\"iconContainer\":\"explainingLabels_iconContainer__1r1N2\",\"sectionLabel\":\"explainingLabels_sectionLabel__Jgmvz\"};","import React from \"react\";\nimport PropTypes from 'prop-types';\nimport styles from './optionsModal.module.css'\n\nconst OptionsModal = ({children}) => (\n  <ul className={styles.container}>\n    {children}\n  </ul>\n);\n\nOptionsModal.propTypes = {\n  children: PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.element, PropTypes.bool])).isRequired\n};\n\nexport default OptionsModal;\n","import React, {useEffect, useRef, useState} from \"react\"\nimport PropTypes from \"prop-types\"\n\nconst TopPagination = (props) => {\n  const {\n    loadMoreButton = <button>Load more</button>,\n    loader = <span>loading...</span>,\n    threshold = 200,\n    toBottom = false,\n    byWindow,\n    fetcher,\n    withScrollHandler,\n    getScrollParent,\n    className,\n    children,\n    ...rest\n  } = props;\n\n  const [{isFetching, page, lastPage}, setState] = useState({\n    isFetching: false,\n    page: 0,\n    lastPage: 0\n  });\n\n  let scrollContainer = useRef(null);\n\n  const hasMore = page < lastPage;\n\n  useEffect(() => {\n    setState({isFetching: true});\n    const returnedValue = fetcher(page + 1);\n    if (returnedValue instanceof Promise)\n      returnedValue.then(({page, lastPage}) => {\n        setState({isFetching: false, page, lastPage});\n        if (typeof toBottom === 'boolean' && toBottom && typeof scrollContainer.current.scrollTo === 'function')\n          scrollContainer.current && scrollContainer.current.scrollTo(0, scrollContainer.current.scrollHeight);\n        else if (toBottom && toBottom.current && typeof toBottom.current.scrollTo === 'function')\n          toBottom.current.scrollTo(0, toBottom.current.scrollHeight);\n      });\n    else\n      setState({isFetching: false});\n\n    if (typeof getScrollParent !== 'undefined') {\n      getScrollParent(scrollContainer);\n    }\n  }, []);\n\n  const loadMore = () => {\n    if (hasMore) {\n      setState({isFetching: true});\n      fetcher(page + 1).then(({page, lastPage}) => {\n        setState({isFetching: false, page, lastPage})\n      });\n    }\n  };\n\n  const handleScroll = (() => {\n    const toTop = byWindow ? window.scrollY - threshold : scrollContainer.current.scrollTop;\n    if (withScrollHandler && !isFetching && hasMore && toTop - threshold <= 0)\n      loadMore()\n  });\n\n  return (\n    <div\n      ref={scrollContainer}\n      className={className}\n      onScroll={handleScroll}\n      {...rest}\n    >\n      {\n        (hasMore && !withScrollHandler && !isFetching)\n        && React.cloneElement(loadMoreButton, {onClick: loadMore})\n      }\n      {\n        isFetching && loader\n      }\n      {\n        children\n      }\n    </div>\n  )\n};\n\nTopPagination.propTypes = {\n  loadMoreButton: PropTypes.element,\n  loader: PropTypes.element,\n  threshold: PropTypes.number,\n  byWindow: PropTypes.bool,\n  fetcher: PropTypes.func.isRequired,\n  withScrollHandler: PropTypes.bool,\n  getScrollParent: PropTypes.func,\n  className: PropTypes.string,\n  children: PropTypes.node,\n  toBottom: PropTypes.oneOfType([\n    PropTypes.bool,\n    PropTypes.object\n  ])\n};\n\nexport default TopPagination;\n","import Http from \"../Http\";\nimport {api} from \"./api\";\n\nexport const get = (page) => Http.get(`${api.dialogs}?page=${page}`);\n\nexport const getByUsername = (username, page) => Http.get(`${api.dialogs}/${username}?page=${page}`);\n","import ExplainingLabel from \"../ExplainingLabel\";\r\nimport {Icon} from \"antd\";\r\nimport React from \"react\";\r\n\r\nconst iconStyle = {fontSize: 21};\r\n\r\nconst BlacklistedExplainingLabel = () =>\r\n    <ExplainingLabel icon={<Icon type={'stop'} style={iconStyle}/>} text='Blacklisted'>\r\n       <span>\r\n           You are blacklisted by this user\r\n        </span>\r\n    </ExplainingLabel>;\r\n\r\nexport default BlacklistedExplainingLabel;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"optionsModal_container__1GZNV\"};","import React, {useEffect, useState} from \"react\";\nimport PropTypes from 'prop-types';\n\nconst Typing = ({ className }) => {\n  const [countOfDots, setCountOfDots] = useState(3);\n\n  useEffect(() => {\n    const id = setTimeout(() => {\n      setCountOfDots(countOfDots === 3 ? 1 : countOfDots + 1)\n    }, 300);\n    return () => clearTimeout(id);\n  });\n\n  return (\n    <span className={className}>is typing {'.'.repeat(countOfDots)}</span>\n  )\n};\n\nTyping.propTypes = {\n  className: PropTypes.string\n};\n\nexport default Typing;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"header_container__13v6o\",\"arrowLeft\":\"header_arrowLeft__2hFbt\",\"avatar\":\"header_avatar__1t7-n\",\"username\":\"header_username__PLVMw\",\"isTyping\":\"header_isTyping__2sruO\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"emojiPicker_container__1J-Eh\"};","module.exports = __webpack_public_path__ + \"static/media/smile.8472c08c.svg\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"footer_container__rIBtM\",\"messageInput\":\"footer_messageInput__2hJ6h\",\"sendButton\":\"footer_sendButton__1f7ws\",\"loader\":\"footer_loader__1YWfX\",\"inputContainer\":\"footer_inputContainer__2nqf2\",\"emojiIcon\":\"footer_emojiIcon__3UBAj\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"post_wrapper__3wMBq\",\"container\":\"post_container__2qTmd\",\"myContainer\":\"post_myContainer__3aS36 post_container__2qTmd\",\"header\":\"post_header__2O9bl\",\"avatar\":\"post_avatar__6sa51\",\"username\":\"post_username__16Nhd\",\"media\":\"post_media__w0ueq\",\"caption\":\"post_caption__2D8bf\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"avatar\":\"avatar_avatar__3VjgK\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"fullScreen_container__3ERjB\",\"scale\":\"fullScreen_scale__2AHTC\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"img\":\"image_img__2i6r3\",\"imgFull\":\"image_imgFull__1f3oh\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"images_container__Kvgv5\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"singleImgContainer\":\"singleImage_singleImgContainer__1iVZY\",\"mySingleImgContainer\":\"singleImage_mySingleImgContainer__37mDz singleImage_singleImgContainer__1iVZY\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"message_wrapper__2TbOf\",\"myWrapper\":\"message_myWrapper__JYQXd message_wrapper__2TbOf\",\"container\":\"message_container__xwdr5\",\"text\":\"message_text__Vsz9G\",\"myText\":\"message_myText__33g_T message_text__Vsz9G\",\"unreadBadge\":\"message_unreadBadge__doRGv\",\"myTime\":\"message_myTime__3Lwsy\",\"time\":\"message_time__2zaNB message_myTime__3Lwsy\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"messagesList_container__S-sNe\",\"absoluteWrapper\":\"messagesList_absoluteWrapper__2ZwQR\",\"messages\":\"messagesList_messages__WD0US\",\"mobileMessages\":\"messagesList_mobileMessages__3wVZT messagesList_messages__WD0US\",\"explainingContainer\":\"messagesList_explainingContainer__3oDh7 dialog_container__1JFX1\",\"date\":\"messagesList_date__2uHkP\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"dialog_container__1JFX1\",\"explainingContainer\":\"dialog_explainingContainer__3naOs dialog_container__1JFX1\"};","import React from \"react\"\nimport PropTypes from \"prop-types\"\nimport {Link} from \"react-router-dom\"\nimport {withRouter} from \"react-router\"\nimport {Icon} from \"antd\"\n\nimport DefaultAvatar from \"components/DefaultAvatar\"\nimport Typing from \"components/Typing\";\n\nimport styles from './header.module.css';\n\nconst Header = ({username, avatar, isTyping, history}) => (\n  <div className={styles.container}>\n    <Icon type={'arrow-left'} className={styles.arrowLeft} onClick={history.goBack}/>\n    <Link to={`/${username}`} className={styles.avatar}>\n      {\n        avatar ? <img src={avatar} alt={'avatar'}/> : <DefaultAvatar fontSize={'20px'}/>\n      }\n    </Link>\n    <Link to={`/${username}`} className={styles.username}>\n      {\n        username\n      }\n    </Link>\n    {\n      isTyping && <Typing className={styles.isTyping}/>\n    }\n  </div>\n);\n\nHeader.propTypes = {\n  username: PropTypes.string.isRequired,\n  isTyping: PropTypes.bool.isRequired,\n  avatar: PropTypes.string\n};\n\nexport default withRouter(Header);\n","import React from \"react\";\nimport {Picker} from \"emoji-mart\";\n\nimport 'emoji-mart/css/emoji-mart.css';\nimport styles from \"./emojiPicker.module.css\";\n\nconst EmojiPicker = ({addEmoji}) => (\n  <div className={styles.container}>\n    <Picker\n      set='apple'\n      color='#1890ff'\n      title='Pick emoji'\n      emoji='point_up'\n      onSelect={addEmoji}\n    />\n  </div>\n);\n\nexport default EmojiPicker;\n","import React, {useCallback, useEffect, useRef, useState} from \"react\";\nimport PropTypes from \"prop-types\"\nimport {useThrottle} from 'use-throttle';\n\nimport EmojiPicker from \"./EmojiPicker\";\n\nimport emojiIcon from './icons/smile.svg';\nimport styles from './footer.module.css';\n\n\nconst Footer = ({sendMessage, typing}) => {\n  let inputRef = useRef(null);\n  const [isSendButtonVisible, setIsSendButtonVisible] = useState(false);\n  const [isEmojiOpen, setIsEmojiOpen] = useState(false);\n  const [messageText, setMessageText] = useState('');\n  const throttledMessageText = useThrottle(messageText, 1200);\n\n  useEffect(() => {\n    if (throttledMessageText.length > 0)\n      typing();\n  }, [throttledMessageText]);\n\n  const onInputChange = (event) => {\n    const value = event.target.value;\n    if (!isSendButtonVisible && value.length > 0)\n      setIsSendButtonVisible(true);\n    else if (event.target.value.length === 0)\n      setIsSendButtonVisible(false);\n    if (value.length < 1000)\n      setMessageText(value);\n  };\n\n  const onSubmit = (event) => {\n    event.preventDefault();\n    if (messageText.length > 0 && messageText.length <= 1000) {\n      sendMessage(messageText);\n      setMessageText('');\n      setIsSendButtonVisible(false);\n      setIsEmojiOpen(false);\n      inputRef.current.focus();\n    }\n  };\n\n  const toggleEmoji = () => {\n    setIsEmojiOpen(!isEmojiOpen);\n  };\n\n  const addEmoji = useCallback((emoji) => {\n    if (messageText.length < 1000) {\n      setMessageText(messageText + emoji.native);\n      inputRef.current.focus();\n      if (!isSendButtonVisible)\n        setIsSendButtonVisible(true);\n    }\n  }, [messageText]);\n\n  return (\n    <>\n      <form className={styles.container} onSubmit={onSubmit}>\n        <div className={styles.inputContainer}>\n          <input\n            type='text'\n            placeholder='Enter your message'\n            ref={inputRef}\n            className={styles.messageInput}\n            maxLength={1000}\n            value={messageText}\n            onChange={onInputChange}\n          />\n          {\n            <button type={'button'} className={styles.emojiIcon} onClick={toggleEmoji}>\n              <img src={emojiIcon} alt={'Emoji'}/>\n            </button>\n          }\n        </div>\n        {\n          isSendButtonVisible &&\n          <button\n            className={styles.sendButton}\n            type='submit'\n          >\n            Send\n          </button>\n        }\n      </form>\n      {isEmojiOpen && <EmojiPicker addEmoji={addEmoji}/>}\n    </>\n  );\n};\n\nFooter.propTypes = {\n  sendMessage: PropTypes.func.isRequired,\n  typing: PropTypes.func.isRequired\n};\n\nexport default Footer;\n","import ExplainingLabel from \"../ExplainingLabel\";\nimport {Icon} from \"antd\";\nimport React from \"react\";\n\nconst iconStyle = {fontSize: 21};\n\nconst StartMessagingLabel = () =>\n    <ExplainingLabel icon={<Icon type={'message'} style={iconStyle}/>} text='Start messaging!'>\n       <span>\n           Send the first message to start a conversation\n        </span>\n    </ExplainingLabel>;\n\nexport default StartMessagingLabel;\n","import React from \"react\";\nimport {Link} from \"react-router-dom\";\n\nimport styles from \"./post.module.css\";\n\nconst Post = ({post, my, postCode}) => {\n  const onLickClick = (event) => {\n    if (post.error)\n      event.preventDefault();\n  };\n\n  return (\n    <div className={styles.wrapper}>\n      <Link to={`/p/${postCode}`} className={my ? styles.myContainer : styles.container} onClick={onLickClick}>\n        <div className={styles.header}>\n          <img src={post.avatar} className={styles.avatar} alt=''/>\n          <span className={styles.username}>{post.owner}</span>\n        </div>\n        {\n          post.error ? <div className={styles.media} error={'Post is no longer available'}/>\n            :\n            post.src && post.src.match('.mp4')\n              ? <video src={post.src} className={styles.media}/>\n              : <img src={post.src} className={styles.media} alt='Post'/>\n        }\n        {\n          post.caption && <span className={styles.caption}>{post.caption}</span>\n        }\n      </Link>\n    </div>\n  );\n};\n\nexport default Post;\n","import {Link} from \"react-router-dom\";\nimport React from \"react\";\n\nimport DefaultAvatar from \"components/DefaultAvatar\";\n\nimport styles from \"./avatar.module.css\";\n\nconst Avatar = React.memo(({my, post, images, username, src}) => (\n  <>\n    {\n      !my && !post && !images &&\n      <Link to={`/${username}`} className={styles.avatar}>\n        {\n          src ? <img src={src} alt={'avatar'}/> : <DefaultAvatar fontSize={'20px'}/>\n        }\n      </Link>\n    }\n  </>\n));\n\nexport default Avatar;\n","import React, {useEffect} from \"react\";\nimport {createPortal} from \"react-dom\";\nimport styles from \"./fullScreen.module.css\";\n\nconst appRoot = document.getElementById('root');\n\nconst FullScreen = ({children, onClose, ...props}) => {\n  useEffect(() => {\n    const listener = event => {\n      if (event.keyCode === 27)\n        onClose();\n    };\n    document.addEventListener('keydown', listener);\n\n    return () => {\n      document.body.style.overflow = \"visible\";\n      document.removeEventListener('keydown', listener);\n    };\n  }, []);\n\n  return (\n    createPortal(\n      <div className={styles.container} onClick={onClose} {...props}>\n        {children}\n      </div>,\n      appRoot\n    )\n  );\n}\n\nexport default FullScreen;\n","import React, {useState} from \"react\";\nimport {LazyLoadImage} from \"react-lazy-load-image-component\";\nimport 'react-lazy-load-image-component/src/effects/blur.css';\nimport FullScreen from \"./FullScreen\";\n\nimport styles from \"./image.module.css\";\n\nconst Image = ({src, ...props}) => {\n  const [isFull, setIsFull] = useState(false);\n\n  const openImage = (event) => {\n    event.stopPropagation();\n    setIsFull(true);\n  };\n\n  const closeImage = (event) => {\n    event && event.stopPropagation();\n    setIsFull(false);\n  };\n\n  return (\n    <>\n      {\n        isFull &&\n        <FullScreen onClose={closeImage}>\n          <img src={src} className={styles.imgFull} alt=''/>\n        </FullScreen>\n      }\n      <LazyLoadImage\n        src={src}\n        alt={'Media'}\n        effect=\"blur\"\n        onClick={openImage}\n        wrapperClassName={styles.img}\n        {...props}\n      />\n    </>\n  )\n};\n\n\nexport default Image;\n","import React from \"react\";\n\nimport Image from \"./Image\";\n\nimport styles from \"./images.module.css\";\n\nconst Images = ({images}) => (\n  <div className={styles.container}>\n    {\n      images && images.map((image, index) => <Image key={index} src={image}/>)\n    }\n  </div>\n);\n\nexport default Images;\n","import React from \"react\";\n\nimport Image from \"../Image\";\n\nimport styles from \"./singleImage.module.css\";\n\nconst SingleImage = ({my, images}) => (\n  <div className={my ? styles.mySingleImgContainer : styles.singleImgContainer}>\n    {\n      images && images.map(image => <Image key={'key'} src={image}/>)\n    }\n  </div>\n);\n\nexport default SingleImage;\n","import React, {useCallback, useState} from \"react\"\nimport PropTypes from \"prop-types\"\nimport Linkify from 'linkifyjs/react'\nimport moment from \"moment\";\n\nimport OptionsModal from \"components/Modal/OptionsModal\";\nimport Modal from \"components/Modal\";\n\nimport Post from \"./Post\";\nimport Avatar from \"./Avatar\";\nimport Images from \"./Images\";\nimport SingleImage from \"./Images/SingleImage\";\n\nimport styles from \"./message.module.css\";\n\n\nconst Message = ({id, username, avatar, post, images, text, my, read, time, deleteMsg, withAvatar = false}) => {\n  const [modalVisible, setModalVisible] = useState(false);\n\n  const openModal = () => {\n    if (my)\n      setModalVisible(true);\n  };\n\n  const closeModal = useCallback(() => {\n    setModalVisible(false);\n  }, []);\n\n  const deleteMessage = useCallback(() => {\n    deleteMsg(id);\n  }, []);\n\n  return (\n    <>\n      <div className={my ? styles.myWrapper : styles.wrapper} onClick={openModal}>\n        {withAvatar && <Avatar my={my} post={post} src={avatar} images={images} username={username}/>}\n        {\n          post\n            ? <Post post={post} my={my} postCode={text.split('/')[4]}/>\n            : <div className={styles.container}>\n              {\n                text.length > 0 || (images && images.length > 1) ?\n                  <div className={my ? styles.myText : styles.text}>\n                    {my && !read && <div className={styles.unreadBadge}/>}\n                    <Linkify>{text}</Linkify>\n                    <Images images={images}/>\n                  </div>\n                  :\n                  <SingleImage my={my} images={images}/>\n              }\n            </div>\n        }\n        <time className={my ? styles.myTime : styles.time}>{moment(time).format('HH:mm')}</time>\n      </div>\n      <Modal visible={modalVisible} onClose={closeModal}>\n        <OptionsModal>\n          {\n            moment().diff(time, 'hours') <= 24 &&\n            <li onClick={deleteMessage}>Delete</li>\n          }\n          <li onClick={closeModal}>Cancel</li>\n        </OptionsModal>\n      </Modal>\n    </>\n  );\n};\n\nMessage.propTypes = {\n  id: PropTypes.number.isRequired,\n  username: PropTypes.string.isRequired,\n  avatar: PropTypes.string,\n  text: PropTypes.string.isRequired,\n  my: PropTypes.bool.isRequired,\n  read: PropTypes.oneOfType([\n    PropTypes.bool,\n    PropTypes.number\n  ]),\n  withAvatar: PropTypes.bool,\n  deleteMsg: PropTypes.func.isRequired\n};\n\nexport default Message;\n","import React from \"react\";\nimport {animated, useSpring} from \"react-spring\";\nimport {useGestureResponder} from \"react-gesture-responder\";\n\nconst Slider = ({children}) => {\n  const [{x}, set] = useSpring(() => ({x: 0}));\n\n  const {bind} = useGestureResponder({\n    onStartShouldSet: () => true,\n    onMove: ({delta, xy}) => {\n      if (delta[0] > 0)\n        set({x: 0, immediate: true});\n      else if (delta[0] < -400)\n        set({x: -400, immediate: true});\n      else\n        set({x: delta[0], immediate: true});\n    },\n    onRelease: ({delta}) => {\n      set({x: 0, immediate: false})\n    }\n  });\n\n  const addResistance = (x) => Math.abs(x) > 40 ? x + (Math.abs(x) - 40) * 0.6 * (x < 0 ? 1 : -1) : x;\n\n  return (\n    <animated.div\n      {...bind}\n      style={{transform: x.interpolate(x => `translateX(${addResistance(x)}px)`)}}\n      >\n      {children}\n    </animated.div>\n  )\n};\n\nexport default Slider;\n","import React, {useRef} from \"react\"\nimport PropTypes from \"prop-types\"\nimport moment from \"moment\"\n\nimport {isMobile} from \"utils/isMobile\"\nimport TopPagination from \"components/TopPagination\"\nimport Loader from \"components/Paginator/Loader\"\nimport StartMessagingLabel from \"components/ExplainingLabels/StartMessagingLabel/StartMessagingLabel\"\n\nimport Message from \"../Message\"\nimport Slider from \"./Slider\"\n\nimport styles from \"./messagesList.module.css\"\n\n\nconst MessagesList = ({messages, getScrollParent, user, myId, getMessages, deleteMsg, isFirstLoading}) => {\n\n  let lastMessage = useRef(null);\n\n  const isNeedAvatar = (messages, index) => {\n    const prevMessage = messages[index - 1];\n    if (Object.is(prevMessage, undefined))\n      return true;\n\n    return prevMessage && prevMessage.owner_id !== messages[index].owner_id\n  };\n\n  const messageDate = (created_at) => {\n    let text;\n    if (lastMessage.current) {\n      let momentLst = moment(lastMessage.current);\n      let momentCur = moment(created_at);\n\n      if (momentLst.format(\"D MMMM YYYY\") !== momentCur.format(\"D MMMM YYYY\")) {\n        if (momentLst.year() === momentCur.year()) {\n          if (momentCur.format(\"D MMMM\") === moment().format(\"D MMMM\"))\n            text = \"today\";\n          else\n            text = momentCur.format(\"D MMMM\");\n        } else\n          text = momentCur.format(\"D MMMM YYYY\");\n      }\n    } else {\n      if (moment(created_at).format(\"D MMMM\") === moment().format(\"D MMMM\"))\n        text = \"today\";\n      else\n      text = moment(created_at).format(\"D MMMM\")\n    }\n    lastMessage.current = created_at;\n\n    return text && <div className={styles.date}>{text}</div>;\n  };\n\n  return (\n    <TopPagination\n      fetcher={getMessages}\n      loader={<Loader/>}\n      withScrollHandler\n      getScrollParent={getScrollParent}\n      className={styles.container}\n      toBottom\n    >\n      <Slider>\n        <div className={isMobile() ? styles.mobileMessages : styles.messages}>\n          <div className={styles.absoluteWrapper}>\n            {\n              !isFirstLoading && messages.length === 0 ?\n                <div className={styles.explainingContainer}>\n                  <StartMessagingLabel/>\n                </div>\n                :\n                messages.map((message, index) => (\n                    <>\n                      {messageDate(message.created_at)}\n                      <Message\n                        key={message.id}\n                        id={message.id}\n                        my={message.owner_id === myId}\n                        avatar={user && user.avatar}\n                        username={user && user.username}\n                        withAvatar={isNeedAvatar(messages, index)}\n                        text={message.text}\n                        read={message.read}\n                        time={message.created_at}\n                        images={message.images}\n                        post={message.post}\n                        deleteMsg={deleteMsg}\n                      />\n                    </>\n                  )\n                )\n            }\n          </div>\n        </div>\n      </Slider>\n    </TopPagination>\n  );\n};\n\nMessagesList.propTypes = {\n  messages: PropTypes.array.isRequired,\n  user: PropTypes.shape({\n    avatar: PropTypes.string,\n    username: PropTypes.string\n  }),\n  myId: PropTypes.number.isRequired,\n  getMessages: PropTypes.func.isRequired,\n  isFirstLoading: PropTypes.bool.isRequired,\n  deleteMsg: PropTypes.func.isRequired,\n  getScrollParent: PropTypes.func.isRequired\n};\n\nexport default MessagesList;\n","\nexport const getImagesUrl = async (text) => {\n  const images = text.match(/https?:\\/\\/[^\"' ]+\\.(?:png|jpg|jpeg|gif).*?(?=( |$))/g);\n  if (images && images.length > 0) {\n    const results = await Promise.allSettled(images.map(isImage));\n    return results\n      .filter(result => result.state !== 'rejected')\n      .map(result => result.value);\n  }\n  return null;\n};\n\nfunction isImage(url) {\n  return new Promise((resolve, reject) => {\n    let timeout = 2000;\n    let timer;\n    let img = new Image();\n\n    img.onerror = img.onabort = function () {\n      clearTimeout(timer);\n      reject();\n    };\n    img.onload = function () {\n      clearTimeout(timer);\n      resolve(url);\n    };\n    timer = setTimeout(function () {\n      reject();\n    }, timeout);\n\n    img.src = url;\n  });\n\n}\n\n","import {useCallback, useReducer, useRef} from \"react\"\nimport * as PostsService from 'services/posts';\nimport * as DialogsService from 'services/dialogs';\nimport {getImagesUrl} from \"utils/getImagesUrl\";\n\nconst getPostCode = (text) => {\n  const postMatches = text.match(/^https?:\\/\\/([^/?#]+)(?:[/?#]|$)/i);\n  let post = postMatches && postMatches.length >= 2;\n  return post ? text.split('/')[4] : null;\n};\n\nconst getPost = async (text) => {\n  let post = null;\n  if (text) {\n    const postCode = getPostCode(text);\n    if (postCode && postCode.length === 36) {\n      await PostsService.getPostByCode(postCode)\n        .then(({data}) => {\n          post = data.post;\n        })\n        .catch(err => {\n          post = {error: err.message}\n        });\n    }\n  }\n  return post;\n};\n\nconst prepareMessage = async (message) => {\n  let {message: text} = message;\n  let post = await getPost(text);\n\n  let images = await getImagesUrl(text);\n  if (Array.isArray(images))\n    Object.is(images[0], undefined)\n      ? images = null\n      : text = text.replace(/https?:\\/\\/[^\"' ]+\\.(?:png|jpg|jpeg|gif|mp4).*?(?=( |$))/g, '');\n\n  return {\n    ...message,\n    post,\n    images,\n    text\n  }\n};\n\nconst initialState = {\n  messages: []\n};\n\nconst READ_MESSAGES = 'READ_MESSAGES';\nconst ADD_MESSAGES = 'ADD_MESSAGES';\nconst ADD_MESSAGE = 'ADD_MESSAGE';\nconst DELETE_MESSAGE = 'DELETE_MESSAGE';\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case READ_MESSAGES:\n      return {\n        messages: state.messages.map(message => {\n          if (!message.read) {\n            message.read = true;\n            return {...message};\n          }\n          return message;\n        })\n      };\n    case ADD_MESSAGES:\n      return {messages: [...action.payload, ...state.messages]};\n    case ADD_MESSAGE:\n      return !state.messages.some(item => item.id === action.payload.id)\n        ? {messages: [...state.messages, action.payload]}\n        : {messages: state.messages};\n    case DELETE_MESSAGE:\n      return {messages: state.messages.filter(msg => msg.id !== action.payload)};\n    default:\n      throw new Error();\n  }\n}\n\nconst useMessages = (username) => {\n  const [{messages}, dispatch] = useReducer(reducer, initialState);\n  let newMessageHandler = useRef(null);\n  let isFirstRender = useRef(true);\n\n  const getMessages = (page) =>\n    new Promise((resolve) => {\n      DialogsService.getByUsername(username, page)\n        .then(async ({data}) => {\n          Promise.all(data.data.map(message => prepareMessage(message)))\n            .then(messages => {\n              isFirstRender.current = false;\n              dispatch({\n                type: ADD_MESSAGES,\n                payload: messages\n              });\n              resolve(data);\n            });\n        });\n    });\n\n  const readAllMessages = () => {\n    dispatch({\n      type: READ_MESSAGES\n    })\n  };\n\n  const onNewMessage = (messageHandler) => {\n    newMessageHandler.current = messageHandler;\n  };\n\n  const addMessage = useCallback((message) => {\n    prepareMessage(message).then(message => {\n      dispatch({\n        type: ADD_MESSAGE,\n        payload: message\n      });\n      newMessageHandler.current();\n    });\n  }, []);\n\n  const deleteMessage = useCallback((id) => {\n    dispatch({\n      type: DELETE_MESSAGE,\n      payload: id\n    });\n  }, []);\n\n  return {\n    messages,\n    addMessage,\n    getMessages,\n    readAllMessages,\n    onNewMessage,\n    deleteMessage,\n    isFirstLoading: isFirstRender.current\n  }\n};\n\nexport default useMessages;\n","import React, {useCallback, useEffect, useRef, useState} from \"react\"\nimport PropTypes from \"prop-types\"\nimport {connect} from \"react-redux\"\nimport {message} from 'antd';\n\nimport BlacklistedExplainingLabel from \"components/ExplainingLabels/BlacklistedLabel/BlacklistedExplainingLabel\"\nimport Loader from \"components/Paginator/Loader\"\n\nimport Header from \"./Header\"\nimport Footer from \"./Footer\"\nimport MessagesList from \"./MessagesList\"\n\nimport * as UsersService from 'services/user'\nimport ws, {types as WsTypes} from \"../../Ws\"\n\nimport useMessages from \"./utils/useMessages\"\n\nimport styles from './dialog.module.css'\n\n\nconst Dialog = ({myId, dispatch, match}) => {\n\n  const username = match.params.username;\n  const [dialogUser, setDialogUser] = useState(null);\n  const [isTyping, setIsTyping] = useState(false);\n  let dialog = useRef(null);\n  let timerRef = useRef(null);\n\n  const {\n    messages, getMessages, addMessage,\n    readAllMessages, onNewMessage, deleteMessage,\n    isFirstLoading\n  } = useMessages(username);\n  const topicName = `dialogs:${myId}`;\n\n  useEffect(() => {\n    UsersService.getUser(username)\n      .then(({data}) => {\n        setDialogUser(data);\n        dispatch.auth.readDialog(data.id);\n      });\n  }, []);\n\n  useEffect(() => {\n    let wsThread = ws.getSubscription(topicName);\n    if (dialogUser && myId && wsThread) {\n\n      wsThread.emit('message', {\n        type: WsTypes.CONNECTION,\n        receiverId: dialogUser.id\n      });\n\n      const webSocketCallback = (data) => {\n        switch (data.type) {\n          case WsTypes.MESSAGE:\n            if (data.message.owner_id === dialogUser.id || data.message.owner_id === myId) {\n              addMessage(data.message);\n              if (data.message.receiver_id === myId) {\n                wsThread.emit('message', {\n                  type: WsTypes.READ,\n                  receiverId: dialogUser.id\n                });\n                readAllMessages();\n              }\n            }\n            break;\n          case WsTypes.CONNECTION:\n            readAllMessages();\n            break;\n          case WsTypes.READ:\n            readAllMessages();\n            break;\n          case WsTypes.IS_TYPING:\n            if (data.owner_id === dialogUser.id) {\n              const time = Date.now();\n              setIsTyping(true);\n              if (timerRef.current)\n                clearInterval(timerRef.current);\n              timerRef.current = setTimeout(() => {\n                if (time + 1500 <= Date.now())\n                  setIsTyping(false)\n              }, 1600);\n            }\n            break;\n          case WsTypes.DELETE:\n            deleteMessage(data.messageId);\n            break;\n          case WsTypes.ERROR:\n            message.error(data.error);\n            break;\n          default:\n            break;\n        }\n      };\n\n      wsThread.on('message', webSocketCallback);\n\n      dialog.current = wsThread;\n\n      return () => wsThread.off('message', webSocketCallback);\n    }\n  }, [dialogUser, myId, ws.getSubscription(topicName)]);\n\n  const sendMessage = useCallback((message) => {\n    dialog.current.emit('message', {\n      type: WsTypes.MESSAGE,\n      receiverId: dialogUser.id,\n      message\n    })\n  }, [dialog, dialogUser]);\n\n  const typing = useCallback(() => {\n    dialog.current.emit('message', {\n      type: WsTypes.IS_TYPING,\n      receiverId: dialogUser.id\n    })\n  }, [dialog, dialogUser]);\n\n  const deleteMsg = useCallback((messageId) => {\n    dialog.current.emit('message', {\n      type: WsTypes.DELETE,\n      receiverId: dialogUser.id,\n      messageId\n    })\n  }, [dialog, dialogUser]);\n\n  const getScrollParent = (ref) => {\n    onNewMessage(() => {\n      ref.current.scrollTo({\n        top: ref.current.scrollHeight,\n        behavior: 'smooth'\n      });\n    });\n  };\n\n  return (\n    <div className={styles.container}>\n      {\n        dialogUser ?\n          <>\n            {\n              dialogUser && dialogUser.amBlacklisted ?\n                <div className={styles.explainingContainer}>\n                  <BlacklistedExplainingLabel/>\n                </div>\n                :\n                <>\n                  <Header username={username} avatar={dialogUser && dialogUser.avatar} isTyping={isTyping}/>\n                  <MessagesList\n                    messages={messages}\n                    user={dialogUser}\n                    myId={myId}\n                    getMessages={getMessages}\n                    isFirstLoading={isFirstLoading}\n                    deleteMsg={deleteMsg}\n                    getScrollParent={getScrollParent}\n                  />\n                  <Footer sendMessage={sendMessage} typing={typing}/>\n                </>\n            }\n          </>\n          : <Loader center/>\n      }\n    </div>\n  )\n};\n\nDialog.propTypes = {\n  myId: PropTypes.number.isRequired,\n};\n\nexport default connect((state) => ({\n  myId: state.auth.user.id\n}))(Dialog);\n"],"sourceRoot":""}